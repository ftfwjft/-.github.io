## 构建高维神经网络势的原子中心对称函数



神经网络提供了一种无偏和数值上非常精确的方法来表示高维从头计算势能面。一旦构建，神经网络势可以提供比电子结构计算快许多数量级的能量和力，从而使大型系统的分子动力学模拟成为可能。然而，笛卡尔坐标并不是一个很好的选择来表示原子的位置，并且需要对对称函数进行转换。利用简单的基准系统，详细讨论了几种适合构造高维神经网络势能面的对称函数的性质。对称函数是通用的，可以应用于所有类型的系统，如分子，晶体和无定形固体，和液体。



#### Introduction

经验势:

- 大多数电势从物理作用的函数形式开始，并包含一些参数，这些参数符合实验数据或从头计算数据(数值精度往往受到潜在势能的固定函数形式的限制)
- 另一种方法是牺牲物理动机的函数形式，以支持无偏的、纯数学拟合程序

在本文中，我们讨论了一种**构建高维神经网络PESs**的方法，它是基于基于环境依赖的原子能贡献的总能量的扩展

前馈神经网络:

![image-20220204123808115](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220204123808115.png)

高维神经网络势:

高维PESs问题：

- 每个自由度都由一个输入节点表示，神经网络的大小显著增加，使得该方法的效率较低
- 一旦神经网络电位被拟合，输入节点的数量就不能改变
- 对于一个含有大量原子的系统，交换相同化学元素的任意两个原子的位置并不改变其结构,这种不变性在前馈神经网络中通常不存在

这些概念问题可以通过用一组原子神经网络代替代表总能量的神经网络来解决:

![image-20220204124259883](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220204124259883.png)

Ei取决于原子的化学环境，它由所有相邻原子在截止半径为Rc的球体内的位置来定义。利用神经网络构建了相邻原子位置与原子能量贡献之间的函数关系。它被训练分配单个的能量到原子通过“学习”基于一组参考能量的PES.

![image-20220204124442781](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220204124442781.png)

首先，将所有原子的笛卡尔坐标Ri = (Xi, Yi, Zi)转换为nn的某个合适的输入坐标集。这些坐标Gi = {Gi, j}被称为对称函数。每个原子得到一组对称函数值，这是其原子神经网络的输入。这就产生了原子的能量贡献，所有的贡献最后加起来得到系统的总能量。对于给定的化学元素，原子神经网络的结构和权重参数是相同的，即拟合的神经网络权重集合对应于系统中化学物种的数量。

该高维神经网络方案适用于具有不同原子数的系统：

如果添加一个原子，则在总能量表达式中添加另一个具有相应元素的结构和权重的原子神经网络。如果一个原子被移除，它的原子神经网络也会被删除。如果原子环境相同，同一元素的两个原子的对称函数值的集合必须相同。因此，对称函数代表了原子的结构指纹。然后，交换任意两个原子的位置仅仅改变了图中线的顺序，但总能量是相同的。



#### 对称函数

##### 性质

- 连续的
- 解析导数必须很容易得到
- 对PES对称性的正确描述
- 原子间距离较大时，原子间的物理相互作用减小，接近于零

##### 高维神经网络的对称函数

![image-20220205100856421](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205100856421.png)

Rij是原子i和j之间的距离，如果Ri j大于截止半径Rc，截止函数及其导数为零。类似的截止函数也用于其他类型的势

虽然这里讨论的所有对称函数都是真正的多体函数，但我们称它们为径向函数和角函数。径向函数构造为两体项的和，角函数另外包含三体项的和。提出了三个适合描述原子i的径向环境的径向对称函数:

![image-20220205101215325](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205101215325.png)

一组径向对称函数可以被认为是对离中心原子不同距离处的配位数的描述。进一步，提出了两类角函数。

![image-20220205101709728](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205101709728.png)

这一角分布可以确定在不同距离的中心原子通过选择合适的η和Rc，以控制径向部分。

![image-20220205101807542](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205101807542.png)

​			只有一个相邻原子的径向对称函数G1、G2和G3。在较大的系统中，一个原子的径向对称函数值是每个相邻原子贡献的总和。对于G2和G3函数，截断Rc  = 11.3 Bohr已经被使用，在(c)面板中位移的G2函数的高斯宽度是η = 3.0 Bohr−2

![image-20220205103146698](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205103146698.png)

​											角对称函数G4的角贡献。函数G5的角向部分是相同的。

![image-20220205103214344](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205103214344.png)

角对称函数的径向部分表示为R  = Ri j = Rik = R jk和Rc = 12玻尔的情况。实线表示G4型角函数的径向部分，虚线表示G5型的径向部分。

![image-20220205103235961](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205103235961.png)

​																				总角函数G4和G5的比较

![image-20220205103338647](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205103338647.png)

​									经网络拟合Lennard-Jones (LJ)二聚体和三聚体能量(菱形符号)作为原子间距离r的函数



![image-20220205103409654](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205103409654.png)

​								二聚体和三聚体的Lennard-Jones能量(菱形符号)图作为径向对称函数值g的函数

![image-20220205103440767](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205103440767.png)

​									神经网络拟合Lennard-Jones二聚体和三聚体能量作为原子间距离R的函数。

![image-20220205103634028](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220205103634028.png)

比较能量(a)和力(b)曲线，得到拟合Lennard-Jones势的径向对称函数与不同的有效空间扩展。实曲线表示用G1型函数拟合。通过采用不同的截止半径Rc来控制空间扩展。虚线曲线用具有可比较空间扩展的G2型函数表示拟合，在这种情况下由参数η控制。在所有情况下都使用了截止玻尔为6.0的G2函数，Rs设为0玻尔。具有可比空间扩展的G1和G2函数用相同的颜色表示。在G1函数中严格的截止结果是能量在截止半径处跳到一个恒定值。这种跳跃也反映在接近Rc的力的较差表示上。用G2函数得到的结果质量好得多，与参考数据(黑菱形)几乎没有区别。

#### 结论



综上所述，讨论了适用于构造高维NN势的对称函数的性质。提出了描述局部原子环境的径向和角对称函数的几种函数形式。所有的函数都是多体函数，明确地依赖于所有原子在局部化学环境中的位置。它们可以用于所有类型的周期和非周期系统，并且与成键性质无关。它们同样适用于非常不同的系统，如大块金属、团簇或分子。使用简单的模型系统，对称函数的仔细分析可以理解拟合过程中可能出现的问题，并获得提高质量的神经网络电位。与简单的解析势相比，所提出的对称函数以及神经网络本身具有相当复杂的形式。虽然这种形式正是该方法数值精度的原因，但其性能低于典型的经典力场。然而，精度接近参考计算，这是典型的电子结构方法，如密度泛函理论。相对于这些方法，神经网络电位可以估计大约4到5个数量级的快。因此，NN势可以显著延长MD模拟的时间尺度和长度尺度。这在复杂的成键情况下尤其如此，而复杂的成键情况不能用简单的势表示，否则就需要从头计算MD模拟。特别是，键的断裂和形成对NN势没有限制，因为它们只依赖于原子的位置。这开启了在材料科学、表面科学和溶液中各种有趣系统的应用，这将极大地受益于准确和快速的可用性。

