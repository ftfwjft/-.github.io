## Machine learning in materials science

[^Machine learning in materials science]: 材料科学中的机器学习



#### Abstract 

传统的发现新材料的方法，如经验试错法和基于密度泛函理论(DFT)的方法，由于开发周期长、效率低、成本高，已经跟不上当今材料科学的发展。因此，机器学习由于其计算成本低、开发周期短，加之强大的数据处理能力和较高的预测性能，正被广泛应用于材料检测、材料分析和材料设计。在本文中，我们讨论了通过机器学习分析材料性能的基本操作程序，总结了机器学习算法在材料科学几个成熟领域的最新应用，并讨论了广泛应用所需的改进。

#### Introduction

材料科学的指导思想可以概括为四种范式:

1. 第一种范式是经验试错法
2. 第二种范式是物理化学定律
3. 第三种范式是计算机模拟
4. 第四种范式是大数据驱动科学。其中，随着数据挖掘技术的不断发展和人工智能完善,第四个范式，可以在理论、实验和计算机模拟方面完美统一其他三个范式。

机器学习可以大大降低计算成本，缩短开发周期;因此，它是取代DFT计算甚至重复实验室实验的最有效的方法之一。现在它已经被用来发现新材料，预测材料和分子性质，研究量子化学，设计药物。在本文中，我们不仅阐述了机器学习分析材料性能的基本操作流程，还总结了机器学习算法在材料科学几个成熟领域的应用，并讨论了在广泛应用中需要改进的地方。

![image-20220131161348785](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220131161348785.png)

​																		机器学习的工作流程





####  Data Processing

包括两个部分:数据选择和特征工程

##### 数据选择

在数据选择中，要综合考虑数据的类型、质量和格式等因素，对数据进行选择。使用高质量的数据可以防止考虑错误的、缺失的或冗余的信息

目前，材料科学的数据大致可以分为四种类型:

- 材料性能的实验和模拟(物理、化学、结构、热力学、动力学等)
- 化学反应数据(反应速率、反应温度等)
- 图像数据(材料扫描电镜图像、材料表面照片等)
- 文献数据

这些数据是离散的(如文本)，连续的(如向量和张量)，或以加权图的形式存在由于数据以各种格式存储在各种数据库中，很难考虑来自多个数据库的数据。此外，所需的数据格式取决于所应用的机器学习算法。因此，在数据处理过程中，需要统一数据的格式，选择适合机器学习算法的数据表示形式。指纹、微笑、加权图和库仑矩阵是常见的数据表示。

![image-20220131161827954](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220131161827954.png)

​																一个分子数据的各种表示形式



##### 特征工程

数据选择后，需要提取出适合预测目标的特征，这称为特征工程。特征工程是指从原始数据中提取特征，以实现算法应用的过程。

![image-20220131162002502](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220131162002502.png)

上图给出了机器学习工作流程中的特征工程。传统的机器学习方法(浅层学习)需要人工选择特征。

然而，人工特征工程并不是一个理想的解决方案。人类经验的局限性使得难以识别预测目标最具代表性的特征。此外，人工特征工程需要更高的劳动力和计算成本。最近，深度学习的发展已经消除了手工特征工程的需要，这可能成为材料科学机器学习的一个趋势。



#### Modeling

机器学习可以分为有监督学习、无监督学习、半监督学习和强化学习。监督学习又称“跟着老师学习”，即对训练数据的相应输出进行标注。相反，在无监督学习中，训练数据的相应输出是无标记的。对于半监督学习，部分训练数据进行了标记，其余数据不进行标记;未标记数据的数量常常远远超过标记数据的数量。在强化学习中，不是向模型指定如何产生正确的行动，而是使用环境提供的强化信号来评估所产生的行动的质量，并改进适应环境的策略。

实现上述四种机器学习方法的算法是可用的，可以分为两种类型:浅学习和深度学习。

常用模型：

- 支持向量机
- 朴素贝叶斯分类器
- 决策树
- 人工神经网络
- 卷积神经网络
- 递归神经网络



#### MODEL VALIDATION

1. K-fold交叉验证
2. 留一交叉验证(LOOCV)
3. 重复学习测试(RLT)交叉验证
4. 引导交叉验证



####  Material property analysis

##### 降解检测

在材料分析中，对于金属腐蚀、沥青路面开裂的检测以及混凝土强度的确定，机器学习比人判断更准确、更方便。

Agrawal等人探索了机器学习方法(如特征选择和预测建模)通过研究合金的各种性能及其成分和制造工艺参数之间的关系来预测钢的疲劳强度的各种应用。他们集中研究了与疲劳强度相关的25个特征，发现回火温度是影响疲劳强度的最重要特征。

Zhang提出了一种基于CNN的像素级精度的高效架构。从沥青路面的三维图像中，自动检测路面裂缝，准确率高达90.13%。

![image-20220203110631391](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203110631391.png)

​														基于深度学习的铁路轨道检测



##### 纳米材料分析

Oh等人成功地应用meta分析方法研究了量子点(QDs)的化学毒性。他们利用文本挖掘从307篇文献研究中提取QD毒性相关数据，并应用随机森林回归模型对数据进行分析。结果表明，量子点的毒性与量子点的表面性质(如壳层、配体、表面修饰等)、直径、检测类型和暴露时间密切相关。

![image-20220203110841459](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203110841459.png)

​												显著影响QD毒性的14个物种的特征



##### 分子性质预测

分子性质预测的高通量密度泛函计算非常耗时。作为替代方法，机器学习是快速预测分子、化合物和材料的结构或性质的可行方法;此外，还可以实现较高的精度。

ElemNet是一个基于DNN的模型，将元素作为预测材料属性的输入。自动提取元素之间的物理化学相互作用和相似点，并进行快速、准确的预测。

与ElemNet类似，Chemception是一个基于CNN的模型，它将化合物的原始数据转换成2D图像，以预测毒性、活性和溶剂化特性。

![image-20220203111000959](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203111000959.png)

​																		材料性能预测的深度神经网络





#### Discovering new materials

##### Structure-oriented design

许多分类和回归算法可用于根据材料的化学成分预测材料的化学成分 

钙钛矿是一种重要的晶体结构。帅华等人使用了各种回归算法(梯度推进回归、核脊回归[KRR]、支持向量回归、高斯过程回归、DT回归、和多层感知器回归)，预测了5158个未开发的HOIPs中稳定的无铅HOIPs，并成功鉴定了6个稳定化合物(C2H5OInBr3,  C2H6NInBr3, NH3NH2InBr3, C2H5OSnBr3, NH4InBr3和C2H6NSnBr3）

Pilania等人开发了一种系统的特征工程方法和一种高效的机器学习模型，用于预测双钙钛矿的电子带隙和选择稳定的候选钙钛矿，双钙钛矿晶体的结构和a位、B位阳离子的化学空间如图：

![image-20220203111225264](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203111225264.png)

Oliynyk等人提出了一种基于随机森林算法的Heusler发现引擎，用于识别新的全Heusler化合物。该模型实现了0.94的高真阳性率，并成功预测了12种新型的Heusler化合物，即MRu2Ga和RuM2Ga  (M = Ti−Co)。

Legrain等人130训练了一个模型，使用实验报告的化合物来预测半heusler化合物的稳定性。



##### Element-oriented design

机器学习可以用来从输入的成分中预测新的化合物及其结构。

Meredig等人构建了基于数千个DFT计算结果的机器学习模型，用于预测任意组分的热力学稳定性。研究人员建立了一个大型的DFT计算结果数据库和两个预测编队能量模型(一个启发式和一个基于机器学习)。然后，他们利用这两个模型扫描了160万个候选三元成分，结合两个模型对最可能的结果进行排序，最终确定了4500个新的稳定材料。

在一个类似的研究中，机器学习被用来研究二元化合物首先，研究人员使用了一种无监督学习算法，根据晶体结构将67个八重奏体化合物分离成不同的类别

在以上讨论的研究中，机器学习已经证明了其在发现新化合物方面的高准确性和潜力。最近，一个基于目标强化生成对抗网络的模型被提出，通过奖励机制生成具有特定化学特征和物理反应的新有机分子

![image-20220203112845543](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203112845543.png)

生成器用真实的分子结构来确定发电机所获得的分子结构是否能够存在。对生成器进行训练，使鉴别器的误差概率最大化。重复这个过程可以提高鉴别器对真假数据的鉴别性能。因此，这种“奖赏机制”强化学习网络可以用来设计具有特殊物理或生物特性的化学结构。



##### 逆设计

深度学习在材料的逆向设计中具有很大的潜力。逆向设计从所需的功能开始，寻找具有这种功能的理想分子结构。

![image-20220203112959172](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203112959172.png)

通过基于DNN和RNN的模型成功地实现了反设计的有机分子与直接从分子描述符重建分子结构不同，反设计模型将分子描述符转换为分子标识符。因此，采用DNN和RNN分别作为编码器和解码器.DNN识别分子结构与材料性质之间的关系，将分子描述符x编码为编码后的分子信息z;RNN将编码后的分子信息z解码为分子结构标识符y，将编码后的分子描述符重构为分子结构。如果RNN输出的分子结构稳定且分子性质与目标一致，则分子的反设计成功。

##### 药物设计

药物设计是机器学习应用较为成熟的领域之一。以小分子为模型的机器学习方法可以处理蛋白质的结构复杂性，并可以准确预测结构活性关系，这有助于发现目标药物。

药物发现的典型机器学习过程是从已经测试过的化合物开始的。然后，反复设计和选择批次的化合物进行平行测试。活性模型在每一步都被细化，以选择最有希望用于下一批的化合物，重复这个过程，直到活性药物被识别出来这是一种发现活性药物的有效方法;然而，它的开发周期很长，计算成本也很高。

![image-20220203113145225](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203113145225.png)

现代药物发现策略包括基于配体的药物设计(LBDD)和基于结构的药物设计(SBDD)技术，其中步骤使用机器学习来简化计算或建立统计验证模型。LBDD包括相似性搜索(使用来自一个或多个化合物的2D或3D信息来计算相似性指数，以便对未知数据库中的化合物进行排序)和构建分类或回归模型来预测生物活性。

AtomNet是第一个基于深度cnn的分子结合亲和力体系结构，应用于基于结构的药物发现的生物活性预测它直接预测蛋白质的结构，在SBDD中取得了良好的效果。



##### 量子化学

在量子化学领域，机器学习常常用来代替或与计算机模拟(DFT)相结合来简化复杂问题的计算。

过使用DFT数据来训练机器学习模型，Seko等人在不牺牲模型准确性的情况下大幅降低了计算成本。基于DFT数据训练的模型已被用来预测单一和二元化合物的熔化温度作为一种数据驱动的方法，机器学习可以绕过复杂方程(如Kohn-Sham方程或Schrödinger方程)的解来确定与分子势能表面的能量、几何和曲率相关的性质。

![image-20220203113355700](https://gitee.com/ftfwjft/images/raw/master/image/cloud/image-20220203113355700.png)

​		预测分子中原子能量和局部化学势的深度张量神经网络。将分子编码为核电荷矢量和原子间距离矩阵，作为神经网络的输入



#### 前景

机器学习由于其强大的预测性能和相对较低的计算成本，被广泛应用于性质预测、新材料的发现和量子化学的探索。然而，机器学习在材料科学中的应用仍然面临许多问题。例如，现有的与材料相关的高质量数据不足，材料的性质难以完美表示，预测精度低于DFT计算。

首先，**加速材料数据库的构建**对于机器学习的未来发展至关重要。作为一种数据驱动的方法，数据的数量和质量直接影响机器学习的准确性。科学文献和实验记录包含了大量可以应用机器学习的材料数据，如分子性质、反应条件和合成配方。分散在文章、期刊和杂志中的数据可以迅速收集起来，这将大大丰富现有的资料数据库，并使建立专门的数据库成为可能。

其次，**建立机器学习的新原则**是必要的。随着深度学习的发展和人工特征工程的替代，未来的原始数据将会得到更有效的表示。然而，专家们仍然不了解dnn选择特征的基础和所选择的特征的含义。这使得深度学习的结果难以令人信服，无法产生广泛适用的理论。试图理解“黑匣子”内部发生了什么，不仅增强了材料科学中机器学习的泛化性，也有助于识别人类未知的自然规律。

第三，**量子化学**可能是机器学习的另一个关键应用。机器学习强大的数据处理能力使其能够解决量子化学中的许多问题。将DFT与机器学习相结合，可以大大提高模型的预测精度。这可能是一个强大的工具，用于预测分子的复杂性质和结构，用于研究量子多体系统和发现新材料。由于材料数据不足，机器学习在应用于某些任务时仍然不能达到预期的精度。因此，在某些场景中，在较小但准确的数据集上训练出更精确的模型是绝对必要的。在4000个样本的小数据集上训练的深度学习模型的性能已被证明是足够的
